<!DOCTYPE html>
<html lang="en">



<head>
  
  <meta charset="UTF-8" />
  <meta
    name="description"
    content="This is a really informal post of my understanding of polynomial commitments. I am in no way a professional in cryptography and is just learning this for fun."
  />
  <meta property="og:title" content="Polynomial Commitments">
  <meta property="og:description" content="This is a really informal post of my understanding of polynomial commitments. I am in no way a professional in cryptography and is just learning this for fun.">
  <meta property="og:type" content="website">
  <meta property="og:image" content="https://lonerapier.xyz/icon.png">
  <meta property="og:url" content="https://lonerapier.xyz/thoughts/polynomial-commitments/">
  <meta property="og:width" content="200">
  <meta property="og:height" content="200">
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Polynomial Commitments" />
  <meta name="twitter:description" content="This is a really informal post of my understanding of polynomial commitments. I am in no way a professional in cryptography and is just learning this for fun." />
  <meta name="twitter:image" content="https://lonerapier.xyz/icon.png">
  
    
      
      <meta name="twitter:site" content="lonerapier" />
    
  
    
  

  <title>
    Polynomial Commitments
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  
  
  
  
  
  <link rel="shortcut icon" type="image/png"  href="https://lonerapier.xyz//icon.png" />
  

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    
    
  
  
  <link href="https://lonerapier.xyz/styles.1ba07200d07447d1a27365d5e947dfab.min.css" rel="stylesheet" />

  
  <link href="https://lonerapier.xyz/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css" rel="stylesheet" id="theme-link">

   
  
  
  
  
  <script src="https://lonerapier.xyz/js/darkmode.0c1a5ee5e865a5980ee5f388f8a98f80.min.js"></script>
  
  
  
  <script src="https://lonerapier.xyz/js/util.00639692264b21bc3ee219733d38a8be.min.js"></script>
  
  
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css" as="style"
      onload="this.onload=null;this.rel='stylesheet'"
      integrity="sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"
        integrity="sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx"
        crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js"
        integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR"
        crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/copy-tex.min.js"
        integrity="sha384-ww/583aHhxWkz5DEVn6OKtNiIaLi2iBRNZXfJRiY1Ai7tnJ9UXpEsyvOITVpTl4A"
        crossorigin="anonymous"></script>


  
  



  <script src="https://cdn.jsdelivr.net/npm/@floating-ui/core@1.2.1"></script>
  <script src="https://cdn.jsdelivr.net/npm/@floating-ui/dom@1.2.1"></script>
  
  <script defer src="https://lonerapier.xyz/js/popover.aa9bc99c7c38d3ae9538f218f1416adb.min.js"></script>

  
  
  
  <script defer src="https://lonerapier.xyz/js/code-title.ce4a43f09239a9efb48fee342e8ef2df.min.js"></script>
  

  
  
  <script defer src="https://lonerapier.xyz/js/clipboard.2913da76d3cb21c5deaa4bae7da38c9f.min.js"></script>
  

  
  
  <script defer src="https://lonerapier.xyz/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js"></script>
  

  
   
  <script>
    const SEARCH_ENABLED =  null 
    const LATEX_ENABLED =  true 
    const PRODUCTION =  true 
    const BASE_URL = "https://lonerapier.xyz/"
    const fetchData = Promise.all([
          fetch("https:\/\/lonerapier.xyz\/indices\/linkIndex.9472711a5b0303332442fb0bf9755dfb.min.json")
            .then(data => data.json())
            .then(data => ({
              index: data.index,
              links: data.links,
            })),
          fetch("https:\/\/lonerapier.xyz\/indices\/contentIndex.e3f1b1b334c5fed8daf4eb0aaa65393b.min.json")
            .then(data => data.json()),
        ])
        .then(([{index, links}, content]) => ({
          index,
          links,
          content,
        }))

      const render = () => {
      

      const siteBaseURL = new URL(BASE_URL);
      const pathBase = siteBaseURL.pathname;
      const pathWindow = window.location.pathname;
      const isHome = pathBase == pathWindow;

      addCopyButtons();
      

      addTitleToCodeBlocks();
      

      addCollapsibleCallouts();
      

      
      initPopover(
        "https://lonerapier.xyz",
         true 
      )
      

      
      const footer = document.getElementById("footer")
      if (footer) {
        const container = document.getElementById("graph-container")
        
        if (!container) return requestAnimationFrame(render)
        
        container.textContent = ""

        const drawGlobal = isHome &&  false ;
        drawGraph(
            "https://lonerapier.xyz",
            drawGlobal,
            [{"/moc":"#4388cc"}],
            drawGlobal ? {"centerForce":1,"depth":-1,"enableDrag":true,"enableLegend":false,"enableZoom":true,"fontSize":0.5,"linkDistance":1,"opacityScale":3,"repelForce":1,"scale":1.4} : {"centerForce":1,"depth":1,"enableDrag":true,"enableLegend":false,"enableZoom":true,"fontSize":0.6,"linkDistance":1,"opacityScale":3,"repelForce":2,"scale":1.2}
          );

        }
      

      
        var els = document.getElementsByClassName("mermaid");
        if (els.length > 0) {
          import('https://unpkg.com/mermaid@9/dist/mermaid.esm.min.mjs').then(
            (obj) => {
              
              
              obj.default.init();
            }
          )
        }
      
      
      
      function clickHandler(evt) {
        const target = evt.target 
        const classNames = target.className.split(" ")
        const broken = classNames.includes("broken")
        const internal = classNames.includes("internal-link")
        plausible("Link Click", {
          props: {
            href: target.href,
            broken,
            internal,
            graph: false,
          }
        })
      }

      const links = document.querySelectorAll("a")
      for (link of links) {
        if (link.className.includes("root-title")) {
          link.addEventListener('click', clickHandler, {once: true})
        }
      }
    }

    const init = (doc = document) => {
      
      addCopyButtons();
      

      addTitleToCodeBlocks();
      renderMathInElement(doc.body, {
        delimiters: [
          {left: '$$', right: '$$', display: true},
          {left: '$', right: '$', display: false},
        ],
        macros: {
          'â€™': "'"
        },
        throwOnError : false
      });
      
    };
  </script>
  
  
  <script type="module">
    import { attachSPARouting } from "https:\/\/lonerapier.xyz\/js\/router.d6fe6bd821db9ea97f9aeefae814d8e7.min.js"
    attachSPARouting(init, render)
  </script>
  
  
  <script defer data-domain="lonerapier.xyz" src="https://plausible.io/js/script.js"></script>
  <script>window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments) }</script>
</head>


<body>
<div id="search-container">
  <div id="search-space">
    <input autocomplete="off" id="search-bar" name="search" type="text" aria-label="Search"
      placeholder="Search for something..." dir="">
    <div id="results-container">
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js"
  integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin="anonymous" defer></script>

<script defer src="https://lonerapier.xyz/js/full-text-search.e6e2e0c213187ca0c703d6e2c7a77fcd.min.js"></script>



<div class="singlePage">
    
    <header>
    
    <h1 id="page-title"><a class="root-title" href="https://lonerapier.xyz/">lonerapier.xyz</a></h1>
    <div class="spacer"></div>
    <div id="search-icon">
      <p>Search</p>
      <svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg>
    </div>
    <div class='darkmode'>
    <input class='toggle' id='darkmode-toggle' type='checkbox' tabindex="-1">
    <label id="toggle-label-light" for='darkmode-toggle' tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="dayIcon" x="0px" y="0px" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35;" xml:space="preserve">
            <title>Light Mode</title>
            <path d="M6,17.5C6,16.672,5.328,16,4.5,16h-3C0.672,16,0,16.672,0,17.5    S0.672,19,1.5,19h3C5.328,19,6,18.328,6,17.5z M7.5,26c-0.414,0-0.789,0.168-1.061,0.439l-2,2C4.168,28.711,4,29.086,4,29.5    C4,30.328,4.671,31,5.5,31c0.414,0,0.789-0.168,1.06-0.44l2-2C8.832,28.289,9,27.914,9,27.5C9,26.672,8.329,26,7.5,26z M17.5,6    C18.329,6,19,5.328,19,4.5v-3C19,0.672,18.329,0,17.5,0S16,0.672,16,1.5v3C16,5.328,16.671,6,17.5,6z M27.5,9    c0.414,0,0.789-0.168,1.06-0.439l2-2C30.832,6.289,31,5.914,31,5.5C31,4.672,30.329,4,29.5,4c-0.414,0-0.789,0.168-1.061,0.44    l-2,2C26.168,6.711,26,7.086,26,7.5C26,8.328,26.671,9,27.5,9z M6.439,8.561C6.711,8.832,7.086,9,7.5,9C8.328,9,9,8.328,9,7.5    c0-0.414-0.168-0.789-0.439-1.061l-2-2C6.289,4.168,5.914,4,5.5,4C4.672,4,4,4.672,4,5.5c0,0.414,0.168,0.789,0.439,1.06    L6.439,8.561z M33.5,16h-3c-0.828,0-1.5,0.672-1.5,1.5s0.672,1.5,1.5,1.5h3c0.828,0,1.5-0.672,1.5-1.5S34.328,16,33.5,16z     M28.561,26.439C28.289,26.168,27.914,26,27.5,26c-0.828,0-1.5,0.672-1.5,1.5c0,0.414,0.168,0.789,0.439,1.06l2,2    C28.711,30.832,29.086,31,29.5,31c0.828,0,1.5-0.672,1.5-1.5c0-0.414-0.168-0.789-0.439-1.061L28.561,26.439z M17.5,29    c-0.829,0-1.5,0.672-1.5,1.5v3c0,0.828,0.671,1.5,1.5,1.5s1.5-0.672,1.5-1.5v-3C19,29.672,18.329,29,17.5,29z M17.5,7    C11.71,7,7,11.71,7,17.5S11.71,28,17.5,28S28,23.29,28,17.5S23.29,7,17.5,7z M17.5,25c-4.136,0-7.5-3.364-7.5-7.5    c0-4.136,3.364-7.5,7.5-7.5c4.136,0,7.5,3.364,7.5,7.5C25,21.636,21.636,25,17.5,25z" />
        </svg>
    </label>
    <label id="toggle-label-dark" for='darkmode-toggle' tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="nightIcon" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'" xml:space="preserve">
            <title>Dark Mode</title>
            <path d="M96.76,66.458c-0.853-0.852-2.15-1.064-3.23-0.534c-6.063,2.991-12.858,4.571-19.655,4.571  C62.022,70.495,50.88,65.88,42.5,57.5C29.043,44.043,25.658,23.536,34.076,6.47c0.532-1.08,0.318-2.379-0.534-3.23  c-0.851-0.852-2.15-1.064-3.23-0.534c-4.918,2.427-9.375,5.619-13.246,9.491c-9.447,9.447-14.65,22.008-14.65,35.369  c0,13.36,5.203,25.921,14.65,35.368s22.008,14.65,35.368,14.65c13.361,0,25.921-5.203,35.369-14.65  c3.872-3.871,7.064-8.328,9.491-13.246C97.826,68.608,97.611,67.309,96.76,66.458z" />
        </svg>
    </label>
</div>
</header>


    <article>
      <h1>Polynomial Commitments</h1>
      <p class="meta">
        Last updated 
Oct 11, 2022

 
          
<a href="https://github.com/lonerapier/lonerapier.github.io//thoughts/polynomial-commitments.md" rel="noopener">Edit Source</a>


      </p>
      <ul class="tags">
          
          <li><a href="https://lonerapier.xyz/tags/cryptography/">
          
            Cryptography
          
            </a>
           </li>
          
          <li><a href="https://lonerapier.xyz/tags/math/">
          
            Math
          
            </a>
           </li>
          
      </ul>
      

<aside class="mainTOC">
    <details >
        <summary>Table of Contents</summary>
        <nav id="TableOfContents">
  <ol>
    <li><a href="#functional-commitments">Functional Commitments</a></li>
    <li><a href="#polynomial-commitment-scheme-pcs">Polynomial Commitment Scheme (PCS)</a></li>
    <li><a href="#kzg-commitments">KZG Commitments</a>
      <ol>
        <li><a href="#notation">Notation</a></li>
        <li><a href="#trusted-setup">Trusted Setup</a></li>
        <li><a href="#proof-evaluation">Proof Evaluation</a></li>
        <li><a href="#verifying-evaluation">Verifying Evaluation</a></li>
        <li><a href="#comparison-to-merkle-trees">Comparison to Merkle Trees</a></li>
        <li><a href="#multiproofs">Multiproofs</a></li>
      </ol>
    </li>
    <li><a href="#resources">Resources</a></li>
  </ol>
</nav>
    </details>
</aside>


      






  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  









  
  
  

  

    
    
    
    
    
    

    
    
    
    
    
    
    
    

    
    
    
    
    
    
    
    

    
    
      
      
      
      
      
    
    

  

  
  
  

  

    
    
    
    
    
    

    
    
    
    
    
    
    
    

    
    
    
    
    
    
    
    

    
    
      
      
      
      
      
    
    

  







  
  
  
  
  
  
  
  
    
    
      
      
    
    
  
    
    
      
      
        
      
      
      
      
    
    
  
    
    
      
      
    
    
  
  
  
  






<p>This is a really informal post of my understanding of polynomial commitments. I am in no way a professional in cryptography and is just learning this for fun. Most of the excerpts in these notes are borrowed from the amazing article by 
<a href="https://dankradfeist.de/ethereum/2020/06/16/kate-polynomial-commitments.html" rel="noopener">Dankrad</a> and 
<a href="https://alinush.github.io/2020/05/06/kzg-polynomial-commitments.html" rel="noopener">Alinush</a>.</p>
<blockquote>
<p><em>My pain</em></p>
<p><em>Is self-chosen</em></p>
<p><em>At least</em></p>
<p><em>So The Prophet says</em></p>
</blockquote>
<p>Now, another song for you to listen along for this ride that you&rsquo;re embarking on with me. 
<a href="https://open.spotify.com/track/5EUsI3LIV042IV5ydksV9y?si=7e97529079ca4e70" rel="noopener">River of Deceit</a> by Mad Season. This was a total random song found while listening to my Daily Mix playlist. Anyways, I like it.</p>
<a href="#commitments"><h1 id="commitments"><span class="hanchor" ariaLabel="Anchor"># </span>Commitments</h1></a>
<p>Contains two algorithms:</p>
<ol>
<li>$commit(m,r) \rightarrow com$</li>
<li>$verify(m,com,r) \rightarrow 0/1$</li>
</ol>
<p>Properties:</p>
<ol>
<li>Binding: can&rsquo;t produce two valid openings for one commitment</li>
<li>Hiding: com doesn&rsquo;t reveal about committed data.</li>
</ol>
<a href="#functional-commitments"><h2 id="functional-commitments"><span class="hanchor" ariaLabel="Anchor"># </span>Functional Commitments</h2></a>
<p>committing to a function $f$ in family $F={f:X\rightarrow Y}$.</p>
<p>Steps followed:</p>
<ol>
<li>$setup()$ -&gt; pp</li>
<li>$commit(f,pp,r)$-&gt;$com$</li>
<li>eval(Prover P, Verifier V): $x\in X$, $y \in Y$ s.t. $f(x)=y$
<ol>
<li>$P(f,pp,x,y,r)$ -&gt; succinct proof $pi$</li>
<li>$V(pp,com,x,y,\pi)$ -&gt; 0/1</li>
</ol>
</li>
</ol>
<p>Three main types of functional commitments possible:</p>
<ol>
<li>Polynomial commitments: Univariate polynomial of at most degree d</li>
<li>Multilinear commitments: Multivariate polynomial</li>
<li>Linear commitments: Linear functions $f_\vec{v}(\vec{u}) = &lt;\vec{u},\vec{v}&gt;=\sum^{i=1}<em>{n}u</em>{i}v_{i}$</li>
</ol>
<blockquote class="info-callout">
<p> different types of PCS:</p>
<ol>
<li>Basic Elliptic curves: Bulletproofs</li>
<li>Bilinear groups: KZG</li>
<li>Groups of unknown order: DARK</li>
<li>Hash functions: FRI</li>
</ol>
<p>More info about comparison between these schemes 
<a href="https://hackernoon.com/kzg10-ipa-fri-and-darks-analysis-of-polynomial-commitment-schemes" rel="noopener">here</a>.</p>
</blockquote>
<a href="#polynomial-commitment-scheme-pcs"><h2 id="polynomial-commitment-scheme-pcs"><span class="hanchor" ariaLabel="Anchor"># </span>Polynomial Commitment Scheme (PCS)</h2></a>
<ul>
<li>
<p>what properties are desirable for an efficient PCS? :: commitment time is fast and proof is small, verify/eval time is fast</p>
</li>
<li>
<p>what do you mean by small and fast? :: small means few bytes, for ex: in KZG, it&rsquo;s just one group element and BN254 is just 32 bytes. By fast, i mean in quasilinear time. for ex: verification in KZG takes $O(logd)$, where d is degree of polynomial.</p>
</li>
<li>
<p>see, commitment to a polynomial is just evaluation of that polynomial at a point and brute force method takes $O(d)$ time, where d is the degree of the polynomial and if you want to commit to d polynomials, it amounts to $O(d^2)$ time.</p>
<ul>
<li>there&rsquo;s a better method than that, i.e. NTT Number theory transform which can do this in O(d logd).
<ul>
<li>implement this</li>
</ul>
</li>
<li>even better than this -&gt; use lagrange interpolation to find $f(\tau)$ which is linear in $d$.</li>
</ul>
</li>
<li>
<p>then comes evaluation proofs $\pi_{a}$ -&gt; naively each evaluation proof takes $O(d)$ time, and for $d$ polynomials this goes to $O(d^2)$</p>
<ul>
<li>comes Feist-Khovartovich algorithm, which takes it in $O(d logd)$ if $\Upomega$ domain is multiplicative subgroup.</li>
</ul>
</li>
</ul>
<a href="#kzg-commitments"><h2 id="kzg-commitments"><span class="hanchor" ariaLabel="Anchor"># </span>KZG Commitments</h2></a>
<p>A <strong>polynomial commitment scheme</strong> allows anyone to commit to a polynomial $p(X)$ with the properties that this commitment $C$ (an <a href="/thoughts/elliptic-curves" rel="noopener" class="internal-link" data-src="/thoughts/elliptic-curves">elliptic curve</a> point) can later be verified by anyone at any position $z$ on that polynomial. The prover proves at a position the value of the polynomial known as <em>proof</em> $\pi$ versus the claimed value known as <em>evaluation</em> $p(z)$ and this is only possible when prover actually has provided proof for that one polynomial that it committed to.</p>
<p>


<img src="https://lonerapier.xyz//thoughts/images/kzg-steps.png" width="auto" alt="kzg-steps"  /></p>
<a href="#notation"><h3 id="notation"><span class="hanchor" ariaLabel="Anchor"># </span>Notation</h3></a>
<ul>
<li>Let $\mathbb{G_1}$ and $\mathbb{G_2}$ be two elliptic curves with a pairing $e: \mathbb{G}_1 \times \mathbb{G}_2 \rightarrow \mathbb{G}_T$.</li>
<li>Let $p$ be the order of $\mathbb{G}_1$ and $\mathbb{G}_2$ and $G$ is generator of $\mathbb{G}_1$ and $H$ is generator of $\mathbb{G}_2$.</li>
<li>$[x]_1 = xG \in \mathbb{G}_1$ and $[x]_2 = xH \in \mathbb{G}_2$ where $x \in \mathbb{F}_p$.</li>
</ul>
<a href="#trusted-setup"><h3 id="trusted-setup"><span class="hanchor" ariaLabel="Anchor"># </span>Trusted Setup</h3></a>
<p>You might&rsquo;ve read multiple times in twitter threads that there is a trusted ceremony that is associated with DAS, SNARKs or words like KZG Ceremony. They are usually talking about this trusted setup. Also known as 
<a href="https://vitalik.ca/general/2022/03/14/trustedsetup.html#what-does-a-powers-of-tau-setup-look-like" rel="noopener">Powers of tau</a>.</p>
<p>In this ceremony, a random secret $\tau \in \mathbb{F}_p$ is created, using which its powers $[\tau^i]_1$ and $[\tau^i]_2$ for $i = 0, \ldots, n-1$  are created. In additive notation, it is represented as:</p>
<p>$$[\tau^i]_1 = (G, \tau G, \tau^2 G, \ldots, \tau^{n-1} G) \in \mathbb{G}_1$$
$$[\tau^i]_2 = (H, \tau H, \tau^2 H, \ldots, \tau^{n-1} H) \in \mathbb{G}_2$$</p>
<p>These elements which are just elliptic curve points are made public but the secret has to be destroyed otherwise this ceremony has no meaning as anyone will be able to forge invalid proofs later. In practice this is usually implemented via a secure multiparty computation (MPC), which uses multiple participants to derive these elements and require all participants together to know secret $\tau$. Thus, this has a nice 1-to-N security assumption, basically only 1 honest participant is required which is easy to obtain.</p>
<p>Now, you must be thinking what are they used for? We know that a polynomial is represented as:</p>
<p>$$Polynomial: p(X) = \sum_{i=0}^{n}p_iX^i$$</p>
<p>Now, the prover can compute the commitment to the polynomial as:</p>
<p>$$Commitment: C = [p(\tau)]_{1}$$</p>
<p>$$= \left[\sum_{i=0}^{n} p_{i} {\tau}^{i}\right] = \sum_{i=0}^{n}p_i[\tau^i]$$</p>
<p>This is a really interesting output, as prover is able to evaluate polynomial at point $\tau$, even when he doesn&rsquo;t know the secret and this becomes the commitment of prover of the polynomial.</p>
<p>Now, you might be wondering if a malicious prover find another polynomial $q(X) \neq p(X)$ such that $[q(\tau)]_1 = [p(\tau)]_1$. But the prover doesn&rsquo;t know $\tau$, so the best bet for prover to achieve $p(\tau) = q(\tau)$ is to make the polynomial pass through as many points $n$ as possible. But it&rsquo;s computably inefficient to find the exact polynomial that passes through $n$ points where curve order $p \approx 2^{256}$ as $n &laquo;&lt; p$.</p>
<a href="#proof-evaluation"><h3 id="proof-evaluation"><span class="hanchor" ariaLabel="Anchor"># </span>Proof Evaluation</h3></a>
<p>We need a mechanism so that prover could verify its commitment on the polynomial and this is done through <em>evaluations</em> on the polynomial $p(X)$. Evaluation is done at a point $z$ and the claimed value $p(z)$ is verified by the verifier.</p>
<p>Now, a value $z$ is chosen such that $p(z) = y$. This means that $p(X)-y$ should have a factor $X-z$. So, a quotient polynomial $q(X) = \frac{p(X) - y}{X-z}$ is computed and the evaluation proof becomes,</p>
<p>$$\pi = [q(\tau)]_1$$</p>
<p>$$ = \sum_{i=0}^{n}[\tau^i] \cdot q_i$$</p>
<p>Prover sends this proof to verifier which verifiers this proof.</p>
<a href="#verifying-evaluation"><h3 id="verifying-evaluation"><span class="hanchor" ariaLabel="Anchor"># </span>Verifying Evaluation</h3></a>
<p>Now, verifier has following things:</p>
<ul>
<li>Polynomial: $p(X) = \sum_{i=0}^{n}p_iX^i$</li>
<li>Commitment: $C = \sum_{i=0}^{n}p_i[\tau^i]$</li>
<li>Evaluation point: $z$</li>
<li>Claimed value: $y$</li>
<li>Proof: $\pi = [q(\tau)]_1$</li>
</ul>
<p>Now verifier wants to verify that claimed value is indeed correct using the proof. That&rsquo;s where <a href="/thoughts/bilinear-pairings" rel="noopener" class="internal-link" data-src="/thoughts/bilinear-pairings">pairings</a> come into play. Pairings allow us to multiply two polynomials in different curves and get the output in a target curve. This unfortunately is not possible in a single curve which is a property called Fully Homomorphic Encryption for elliptic curves. ECs are only homomorphic additively.</p>
<p>Verifier checks the following equation:</p>
<p>$$e(\pi, [\tau]_2-[z]_2) = e(C-[y]_1, H)$$</p>
<blockquote>
<p>Note: verifier has $[\tau]_2$ from the trusted setup and $[\tau - z]_2$ is computed through EC arithmetic.</p>
</blockquote>
<p>This convinces verifier that claimed value is indeed the evaluation of the committed polynomial at the point $z$. How? Let&rsquo;s unroll the equation,</p>
<p>$$e(\pi, [\tau]_2-[z]_2) = e(C-[y]_1, H)$$
$$e(\pi, [\tau-z]_2) = e(p[\tau]_1-[y]_1, H)$$
$$[q(\tau) \cdot (\tau-z)]_T = [p(\tau)-y]_T$$</p>
<p>We need two properties from this equation:</p>
<ul>
<li>Correctness: If prover followed right steps, then proof is correct.</li>
<li>Soundness: if they produce incorrect proof, verifier won&rsquo;t be convinced.</li>
</ul>
<p>Correctness checks out as this equation is similar to what we defined in the quotient polynomial $q(X)(X-z) = p(X)-y$.</p>
<p>For soundness, prover would have to compute incorrect proof,</p>
<p>$$\pi&rsquo; = (C - [y&rsquo;]_1)^{\frac{1}{\tau-z}}$$</p>
<p>But it&rsquo;s not possible to do this as $\tau$ is not known to prover and if they can forge this proof, then they can convince verifier for anything.</p>
<a href="#comparison-to-merkle-trees"><h3 id="comparison-to-merkle-trees"><span class="hanchor" ariaLabel="Anchor"># </span>Comparison to Merkle Trees</h3></a>
<p>Merkle trees are a form of <em>vector commitments</em>, i.e. Using a merkle tree of depth $d$ will have $2^{d}-1$ elements, anyone can compute a commitment to a vector $(a_0, a_1, a_2, \ldots, a_{2^d-1})$. Thus, using Merkle trees anyone can prove that element a_i is a member of a vector at position i using d hashes.</p>
<p>


<img src="https://lonerapier.xyz//thoughts/images/merkle-tree.png" width="auto" alt="merkle-tree"  /></p>
<p>You can even make polynomial commitment out of Merkle trees. A polynomial is represented as $p(X) = \sum_{i=0}^{n} p_i X^i$, using $a_i = p_i$, we can construct a polynomial of degree $n = 2^d-1$ and computing merkle root of the coefficients. Now, the prover can prove the evaluation by sending all the $p_i$ and verifier verifying the evaluation by computation $p(z) = y$.</p>
<p>This is a very simple polynomial commitment that is inefficient to its core but will help to understand the marvel KZG commitment is.</p>
<ul>
<li>Prover has to send all the $p_i$ to verifier in order to commence verification. So, proof size is linear with the degree of the polynomial. While in Kate Commitments, commitment and proof size is just one group element of an elliptic group. Commonly used pairing curve is BLS12-381, that would make proof size to be 48 bytes.</li>
<li>The verifier need to do linear work to compute $z$. While in KZG, verification is constant as only two multiplications and pairings are required to verify proof.</li>
<li>commitments using merkle trees makes the polynomial public and doesn&rsquo;t hide anything. While it&rsquo;s mostly hidden in Kate commitments.</li>
</ul>
<p>Now, the best part about Kate proofs are it can create one proof for multiple evaluation, i.e. only one group element for multiple proofs. <sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup></p>
<a href="#multiproofs"><h3 id="multiproofs"><span class="hanchor" ariaLabel="Anchor"># </span>Multiproofs</h3></a>
<p>Let&rsquo;s say we have a list of $k$ points that we want to prove, $(z_0, y_0), (z_1, y_1), \ldots, (z_k, y_k)$. We find a polynomial $I(X)$ that goes through these points using Lagrange Interpolation:</p>
<p>$$I(X) = \sum_{i=0}^{k-1} y_i \prod_{j=0 \atop j \neq i}^{k-1} \frac{X-z_j}{z_i-z_j}$$</p>
<p>For the evaluation proof, while in the single proof we compute $q(x) = \frac{p(x)-y}{x-z}$, we will replace $y$ as single point with $I(x)$, and $x-z$ will be replaced with $Z(x) = \prod_{i=0}^{k}x-z_i$. Now, we replace our values and $q(x)$ becomes</p>
<p>$$q(x) = \frac{p(x) - I(x)}{Z(x)}$$</p>
<p>This is possible due to $p(x)-I(x)$ being divisible by all linear factors of $Z(x)$ and being divisible by whole $Z(x)$. The multiproof for evaluation $(z_0, y_0), (z_1, y_1), \ldots, (z_k, y_k)$: $\pi = [q(s)]_1$. Now, our prover equation becomes</p>
<p>$$e(\pi,[Z(s)]<em>{2})=e(C-[I(s)]</em>{1},H)$$</p>
<p>$$[q(s) \cdot Z(s)]_{T} = [p(s)-I(s)]_T$$</p>
<p>This really blew my mind when I was first studying them. You can have a million proofs batch together in one single 48 bytes proof which anyone can verify by just computing $I(x)$ and $Z(x)$.  Cryptography really is cool.</p>
<a href="#resources"><h2 id="resources"><span class="hanchor" ariaLabel="Anchor"># </span>Resources</h2></a>
<ul>
<li>
<a href="https://dankradfeist.de/ethereum/2020/06/16/kate-polynomial-commitments.html" rel="noopener">KZG Commitments By Dankrad</a></li>
<li>
<a href="https://hackmd.io/yqfI6OPlRZizv9yPaD-8IQ?view" rel="noopener">Kate Commitments in ETH</a></li>
<li>
<a href="https://ethresear.ch/t/open-problem-ideal-vector-commitment/7421/27" rel="noopener">ethresear.ch post about commitments</a></li>
<li>
<a href="https://ethresear.ch/t/using-polynomial-commitments-to-replace-state-roots/7095" rel="noopener">Using polynomial commitments to replace state roots</a>]</li>
<li>
<a href="https://hackmd.io/@tompocock/Hk2A7BD6U" rel="noopener">Kate Commitments: A Primer</a></li>
<li>
<a href="https://taoa.io/posts/Understanding-KZG10-Polynomial-Commitments" rel="noopener">Understanding KZG10 Polynomial Commitments</a></li>
<li>
<a href="https://github.com/ethereum/consensus-specs/pull/3006" rel="noopener">Polynomials in bit reversal permutation</a></li>
<li>
<a href="https://hackmd.io/@Evaldas/SJ9KHoDJF" rel="noopener">Formulas for Polynomial Commitments</a></li>
<li>
<a href="https://scroll.io/blog/kzg" rel="noopener">Uncovering KZG</a></li>
</ul>
<section class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1" role="doc-endnote">
<p>This is the first footnote.&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</section>


    </article>
    

<hr/>


<div class="page-end" id="footer">
    <div class="backlinks-container">
        <h3>Backlinks</h3>
<ul class="backlinks">
    
    
    
    
    
    
    
    <li>
      No backlinks found
    </li>
    
</ul>

    </div>
    <div>
        <script
  src="https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js"
  integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI="
  crossorigin="anonymous"
></script>
<h3>Interactive Graph</h3>
<div id="graph-container"></div>
<style>
  :root {
    --g-node: var(--secondary);
    --g-node-active: var(--primary);
    --g-node-inactive: var(--visited);
    --g-link: var(--outlinegray);
    --g-link-active: #5a7282;
  }
</style>

<script src="https://lonerapier.xyz/js/graph.6579af7b10c818dbd2ca038702db0224.js"></script>

    </div>
</div>






<div id="contact_buttons">
    <footer>
        
        
        <p>Made by Sambhav <lonerapier> using <a href="https://github.com/jackyzha0/quartz">Quartz</a>, Â© 2023</p>
        <ul>
            
            <li><a href="https://lonerapier.xyz/">Home</a></li>
            <li><a href="https://twitter.com/lonerapier">Twitter</a></li><li><a href="https://github.com/lonerapier">Github</a></li></ul>
    </footer>
</div>


</div>
</body>
</html>
